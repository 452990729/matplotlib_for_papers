<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.13: http://docutils.sourceforge.net/" />
<title>Creating publication-quality figures with Matplotlib</title>
<style type="text/css">

@import url("reset.css");

/*
 * ┌──────────────────────────────────────────────────────────────────────────┐
 * │                                                                     Body │
 * └──────────────────────────────────────────────────────────────────────────┘
 */
body {
    color: #333333;
    font-family: "optima", "lucida grande", "lucida sans unicode",
                 verdana, arial, helvetica, sans-serif;
    font-size: 1.1em;
    line-height: 1.5em;
    margin-top: 0em;
}


/*
 * ┌──────────────────────────────────────────────────────────────────────────┐
 * │                                                                 Document │
 * └──────────────────────────────────────────────────────────────────────────┘
 */
div.document {
    margin-top:     50px;
    margin-bottom:   5em;
    margin-left:   250px;
/*    margin-right:    5em;*/
    margin-right:    10%;
}

h1, h2, h3, h4, h5, h6 {
    font-family: "futura", "lucida grande", "lucida sans unicode",
                 verdana, arial, helvetica, sans-serif;
    font-weight: normal;
    clear: both;
}

h1 {
    font-size:     2em;
    margin-top:    2em;
    padding-top:   2em;
    margin-bottom: 1em;
}

h2 {
    font-size:  1.25em;
    margin-top:    3em;
    margin-bottom: 1em;
    color: #326598;
    padding-left:  2em;
    margin-left:  -2em;
    margin-right: 25%;
    padding-bottom: .5em;
    padding-top:   2em;
  /*  border-bottom: 2px solid #326598;*/
    border-bottom: 1px solid #efefef;

}

h3 {
    font-size:     1em;
    margin-top:    3em;
    margin-bottom: 1em;
    border-bottom: 1px solid #efefef;
    color: #326598;
}

h1.title {
    margin-bottom:  0.0em;
    padding-bottom: 0.0em;
}
h2.subtitle {
    font-size:     1.0em;
    padding-top:   0.5em;
    margin-top:    0.0em;
    color:         #999;
    border-bottom: none;
}

p {
    margin-bottom: 1em;
}

strong {
    font-weight: bold;
}

em {
    font-style: italic;
}

a {
    color: #326598;
    text-decoration: none;
}

a:hover {
    color: #326598;
    text-decoration: underline;
}

hr {
    margin-top: 1em;
    border: 0;
}    


/*
 * ┌──────────────────────────────────────────────────────────────────────────┐
 * │                                                                    Image │
 * └──────────────────────────────────────────────────────────────────────────┘
 */
img {
    text-align : left;
}


.align-right {
    float: right;
}

.aling-left {
    float: left;
}



/*
 * ┌──────────────────────────────────────────────────────────────────────────┐
 * │                                                                   Figure │
 * └──────────────────────────────────────────────────────────────────────────┘
 */
.figure
{
    margin-top:    1em;
    margin-bottom: 1em;
}



/*
 * ┌──────────────────────────────────────────────────────────────────────────┐
 * │                                                                     Math │
 * └──────────────────────────────────────────────────────────────────────────┘
 */
img.math {
    vertical-align: middle;
}
div.body div.math p {
    text-align: left;
}
span.eqno {
    float: right;
}


/*
 * ┌──────────────────────────────────────────────────────────────────────────┐
 * │                                                                    Table │
 * └──────────────────────────────────────────────────────────────────────────┘
 */
table
{
    margin-bottom: 2em;
}
th.head
{
    font-weight: bold;
    text-align: left;
    border-bottom: 1px solid black;
    padding-right: .5em;
}

th.field-name
{
    font-weight: bold;
    text-align: left;
    padding-right: 1em;
}


/*
 * ┌──────────────────────────────────────────────────────────────────────────┐
 * │                                                                     Code │
 * └──────────────────────────────────────────────────────────────────────────┘
 */
tt {
    font-family: monospace;
}
pre {
    padding:    .5em;
    line-height: 1.25em;
    border-left: 3px solid #cccccc;
    background-color: #ffffff;
    font-family: monospace;
    margin-bottom: 1em;

    whitewhite-space: pre-wrap;       /* css-3 */  
    whitewhite-space: -pre-wrap;      /* Opera 4-6 */  
    whitewhite-space: -o-pre-wrap;    /* Opera 7 */  
    word-wrap: break-word;       /* Internet Explorer 5+ */  
    whitewhite-space: -moz-pre-wrap;  /* Older Versions of Mozilla */ 
}


dl.docutils > dd {
    margin-left: 2em;
/*    font-size: 90%;*/
}

dl.docutils > dt {
    font-style: italic;
    color: #000099;
}
.classifier {
    font-style: normal;
    color: #000000;
}
.classifier-delimiter {
    font-style: normal;
    color: #000000;
}

dl > dt  {
    font-family: monospace;
}
dl.method, dl.attribute, dl.function, dl.class {
    margin-bottom: 1em;
}
dl.class > dt, dl.function > dt, dl.method > dt, dl.attribute > dt {
    padding: .25em;
    margin-top: 2em;
    background: #eeeeee;
}
.descname {
    font-weight: bold;
}



/*
 * ┌──────────────────────────────────────────────────────────────────────────┐
 * │                                                         Table Of Content │
 * └──────────────────────────────────────────────────────────────────────────┘
 */

/* Global */
.toctree-wrapper {
    padding-bottom: 3em;
}
.toctree-wrapper ul {
  list-style-type:none;
  padding-bottom: 0;
}
/*
.toctree-l1 {
    margin-bottom: 1em;
}
*/
.toctree-l2 {
    padding-left: 2em;
}

/* Local */
li > ul > li {
    padding-left: 2em;
}

div.document .contents {
    margin-bottom: 5em;
}
div.document .topic-title {
    margin-top: 2em;
    font-weight: bold;
}
.contents ul {
  list-style-type:none;
  padding-bottom: 0;
}



/* -------------------------------------------------------------------------
   Admonition
   ------------------------------------------------------------------------- */
div.admonition, div.note {
    float: left;
    line-height: 1.5em;
    font-size: 80%;
    margin: 0;
    padding:          3px 5px;
    margin-left:     -220px;
    width:            200px;
    border-left:     1px solid #cccccc;
}
div.admonition p, div.note p {
    text-align: left;
    margin: 0;
    padding: 0;
}

div.admonition .first, div.note .first {
    font-weight: bold;
}



/* -------------------------------------------------------------------------
   Header
   ------------------------------------------------------------------------- */
div.header {
    padding-top: 25px;
    padding-left:15px;
}

/* -------------------------------------------------------------------------
   Footer
   ------------------------------------------------------------------------- */
div.footer {
    font-family: "futura", "lucida grande", "lucida sans unicode",
                 verdana, arial, helvetica, sans-serif;
    font-size: 75%;
    line-height: 1.5em;
    position: fixed;
    left: 0;
    bottom: 0;
    background-color: #EEE;
    width: 100%;
    border-top: 1px solid;
}
div.footer table {
    width: 98%;
    margin: auto;
}
div.footer table td a {
    color: #777;
    text-decoration: none;
}
div.footer td.left {
    text-align: left;
    width: 25%;
}
div.footer td.center {
    text-align: center;
    width: 50%;
}
div.footer .current {
    background: black;
    color:white;
    margin: 0;
    padding-right: .25em;
    padding-left:  .25em;
}

div.footer td.center a {
    padding-right: .25em;
    padding-left:  .25em;
}

div.footer td.right {
    text-align: right;
    width: 25%;
}

</style>
<style type="text/css">

.hll { background-color: #ffffcc }
.c { color: #408080; font-style: italic } /* Comment */
.err { border: 1px solid #FF0000 } /* Error */
.k { color: #008000; font-weight: bold } /* Keyword */
.o { color: #666666 } /* Operator */
.cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cp { color: #BC7A00 } /* Comment.Preproc */
.c1 { color: #408080; font-style: italic } /* Comment.Single */
.cs { color: #408080; font-style: italic } /* Comment.Special */
.gd { color: #A00000 } /* Generic.Deleted */
.ge { font-style: italic } /* Generic.Emph */
.gr { color: #FF0000 } /* Generic.Error */
.gh { color: #000080; font-weight: bold } /* Generic.Heading */
.gi { color: #00A000 } /* Generic.Inserted */
.go { color: #888888 } /* Generic.Output */
.gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.gs { font-weight: bold } /* Generic.Strong */
.gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.gt { color: #0044DD } /* Generic.Traceback */
.kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.kp { color: #008000 } /* Keyword.Pseudo */
.kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.kt { color: #B00040 } /* Keyword.Type */
.m { color: #666666 } /* Literal.Number */
.s { color: #BA2121 } /* Literal.String */
.na { color: #7D9029 } /* Name.Attribute */
.nb { color: #008000 } /* Name.Builtin */
.nc { color: #0000FF; font-weight: bold } /* Name.Class */
.no { color: #880000 } /* Name.Constant */
.nd { color: #AA22FF } /* Name.Decorator */
.ni { color: #999999; font-weight: bold } /* Name.Entity */
.ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.nf { color: #0000FF } /* Name.Function */
.nl { color: #A0A000 } /* Name.Label */
.nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.nt { color: #008000; font-weight: bold } /* Name.Tag */
.nv { color: #19177C } /* Name.Variable */
.ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.w { color: #bbbbbb } /* Text.Whitespace */
.mf { color: #666666 } /* Literal.Number.Float */
.mh { color: #666666 } /* Literal.Number.Hex */
.mi { color: #666666 } /* Literal.Number.Integer */
.mo { color: #666666 } /* Literal.Number.Oct */
.sb { color: #BA2121 } /* Literal.String.Backtick */
.sc { color: #BA2121 } /* Literal.String.Char */
.sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.s2 { color: #BA2121 } /* Literal.String.Double */
.se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.sh { color: #BA2121 } /* Literal.String.Heredoc */
.si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.sx { color: #008000 } /* Literal.String.Other */
.sr { color: #BB6688 } /* Literal.String.Regex */
.s1 { color: #BA2121 } /* Literal.String.Single */
.ss { color: #19177C } /* Literal.String.Symbol */
.bp { color: #008000 } /* Name.Builtin.Pseudo */
.vc { color: #19177C } /* Name.Variable.Class */
.vg { color: #19177C } /* Name.Variable.Global */
.vi { color: #19177C } /* Name.Variable.Instance */
.il { color: #666666 } /* Literal.Number.Integer.Long */

</style>
</head>
<body>
<div class="document" id="creating-publication-quality-figures-with-matplotlib">
<h1 class="title">Creating publication-quality figures with Matplotlib</h1>
<h2 class="subtitle" id="jean-baptiste-mouret-mouret-isir-upmc-fr-http-pages-isir-upmc-fr-mouret">Jean-Baptiste Mouret -- <a class="reference external" href="mailto:mouret&#64;isir.upmc.fr">mouret&#64;isir.upmc.fr</a> / <a class="reference external" href="http://pages.isir.upmc.fr/~mouret">http://pages.isir.upmc.fr/~mouret</a></h2>

<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#introduction" id="id5">Introduction</a><ul>
<li><a class="reference internal" href="#goal" id="id6">Goal</a></li>
<li><a class="reference internal" href="#what-is-matplolib" id="id7">What is Matplolib?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#basics" id="id8">Basics</a><ul>
<li><a class="reference internal" href="#your-first-plot" id="id9">Your first plot</a></li>
<li><a class="reference internal" href="#plotting-some-data" id="id10">Plotting some data</a></li>
<li><a class="reference internal" href="#changing-the-color-and-the-type-of-line" id="id11">Changing the color and the type of line</a></li>
<li><a class="reference internal" href="#setting-the-limits-and-the-ticks" id="id12">Setting the limits and the ticks</a></li>
</ul>
</li>
<li><a class="reference internal" href="#data-over-time" id="id13">Data over time</a><ul>
<li><a class="reference internal" href="#use-case" id="id14">Use case</a></li>
<li><a class="reference internal" href="#id1" id="id15">Basics</a></li>
<li><a class="reference internal" href="#minimizing-ink" id="id16">Minimizing ink</a></li>
<li><a class="reference internal" href="#a-publication-quality-figure" id="id17">A publication-quality figure</a></li>
<li><a class="reference internal" href="#adding-quartiles" id="id18">Adding quartiles</a></li>
<li><a class="reference internal" href="#better-colors" id="id19">Better colors</a></li>
<li><a class="reference internal" href="#pylab-vs-matplotlib" id="id20">Pylab vs Matplotlib</a></li>
<li><a class="reference internal" href="#subplots" id="id21">Subplots</a></li>
</ul>
</li>
<li><a class="reference internal" href="#box-plot" id="id22">Box plot</a><ul>
<li><a class="reference internal" href="#id2" id="id23">Use case</a></li>
<li><a class="reference internal" href="#id3" id="id24">Basics</a></li>
<li><a class="reference internal" href="#colored-boxes" id="id25">Colored boxes</a></li>
<li><a class="reference internal" href="#stars-statistical-significance" id="id26">Stars (statistical significance)</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<h1><a class="toc-backref" href="#id5">Introduction</a></h1>
<ul class="simple">
<li>This tutorial is hosted on github: don't hesitate to clone the repository and send pull requests. You can access to the repository <cite>here &lt;http://github.com/jbmouret/matplotlib_for_papers&gt;</cite>.</li>
</ul>
<div class="section" id="goal">
<h2><a class="toc-backref" href="#id6">Goal</a></h2>
<ul>
<li><p class="first">Create nice figures for scientific papers</p>
</li>
<li><p class="first">Specific focus on the needs for artificial life and evolutionary computation (use cases: fitness over time, box plot to compare two treatments)</p>
</li>
<li><p class="first"><strong>From the basics to the useful advanced features</strong>: I will not only explains the basics: I will guide you until you get a modern, publication-quality figure.</p>
</li>
<li><p class="first">I will not try to cover every possible plots or every options: this tutorial is not a replacement for the documentation or the already existing tutorials.</p>
<p>For another tutorial about &quot;good&quot; design with matplotlib: <a class="reference external" href="http://nbviewer.ipython.org/gist/olgabot/5357268">http://nbviewer.ipython.org/gist/olgabot/5357268</a> ; most of the suggested best practices have been incorporated in <a class="reference external" href="http://olgabot.github.io/prettyplotlib/">prettyplotlib</a>, an add-on to matplotlib. We are not using this library here because our goal is to teach how to customize matplotlib to your own needs, but many of our suggestion are similar to those performed by prettyplotlib.</p>
</li>
</ul>
<p><strong>Design is always a personal choice</strong>: do your own choices, but take the time to learn the current best practices before choosing to ignore them!</p>
<p>For a more classic and general introduction to matplotlib, check the nice tutorial made by N. Rougier: <a class="reference external" href="http://www.loria.fr/~rougier/teaching/matplotlib/">http://www.loria.fr/~rougier/teaching/matplotlib/</a> [from whom I took the css, thanks to him].</p>
<p>For some inspiration about what is possible, check:</p>
<ul class="simple">
<li>the Matplotlib gallery: <a class="reference external" href="http://matplotlib.org/gallery.html">http://matplotlib.org/gallery.html</a></li>
<li>the Matplotlib examples: <a class="reference external" href="http://matplotlib.org/1.3.1/examples/">http://matplotlib.org/1.3.1/examples/</a></li>
<li>another gallery: <a class="reference external" href="https://github.com/rasbt/matplotlib-gallery">https://github.com/rasbt/matplotlib-gallery</a></li>
<li>and another one: <a class="reference external" href="http://nbviewer.ipython.org/github/cs109/content/blob/master/lec_03_statistical_graphs.ipynb">http://nbviewer.ipython.org/github/cs109/content/blob/master/lec_03_statistical_graphs.ipynb</a></li>
</ul>
<p>Examples of figures:</p>
<div class="admonition-reference admonition">
<p class="first admonition-title">Reference</p>
<p class="last">Tonelli, Paul, and Jean-Baptiste Mouret. &quot;On the relationships between generative encodings, regularity, and learning abilities when evolving plastic artificial neural networks.&quot; <em>PloS one</em> 8.11 (2013): e79138.</p>
</div>
<div class="figure">
<img alt="figs/plosone.png" src="figs/plosone.png" />
</div>
<div class="admonition-reference admonition">
<p class="first admonition-title">Reference</p>
<p class="last">Clune*, Jeff, Jean-Baptiste Mouret*, and Hod Lipson. &quot;The evolutionary origins of modularity.&quot; <em>Proceedings of the Royal Society B: Biological sciences 280.1755 (2013): 20122863</em> [*: equal contribution].</p>
</div>
<div class="figure">
<img alt="figs/plot_fit_mod.png" src="figs/plot_fit_mod.png" />
</div>
<div class="figure">
<img alt="figs/example1_boxplot.png" src="figs/example1_boxplot.png" />
</div>
<div class="figure">
<img alt="figs/example2_heatmap.png" src="figs/example2_heatmap.png" />
</div>
<div class="figure">
<img alt="figs/composite_tasks.png" src="figs/composite_tasks.png" />
</div>
</div>
<div class="section" id="what-is-matplolib">
<h2><a class="toc-backref" href="#id7">What is Matplolib?</a></h2>
<div class="section" id="principle">
<h3>Principle</h3>
<div class="admonition-url admonition">
<p class="first admonition-title">URL</p>
<ul class="last simple">
<li><a class="reference external" href="http://matplotlib.org/">http://matplotlib.org/</a></li>
<li><a class="reference external" href="http://www.numpy.org/">http://www.numpy.org/</a></li>
</ul>
</div>
<ul class="simple">
<li>Library based on Python (easy) and compatible with numpy (powerful math library for Python):</li>
</ul>
<blockquote>
<ul class="simple">
<li>Python script -&gt; pdf/svg/png file</li>
<li>can be used with ipython (interactive use)</li>
<li>can use everything from Python (libraries): <strong>numpy, stat packages, low-level functions, file loaders, ...</strong></li>
<li>=&gt; Everything is possible! (but it sometimes requires some effort)</li>
</ul>
</blockquote>
<ul class="simple">
<li>portable</li>
<li>open source (GPL)</li>
</ul>
</div>
<div class="section" id="installation">
<h3>Installation</h3>
<ul class="simple">
<li>OSX: install brew, then use it to install pip, and use pip to install matplotlib (!).</li>
</ul>
<pre class="code bash literal-block">
<span class="c"># install brew:
</span>ruby -e <span class="s2">&quot;$(curl -fsSL https://raw.github.com/Homebrew/homebrew/go/install)&quot;</span>
<span class="c"># matplotlib will need freetype
</span>brew install freetype
<span class="c"># pip is a package manager for python: https://pypi.python.org/pypi
</span>brew install pip
<span class="c"># now use pip to install matplotlib
</span>pip install numpy
pip install matplotlib
</pre>
<dl class="docutils">
<dt>More info / alternative approaches:</dt>
<dd><ul class="first last simple">
<li>you can install Canopy Express (full python environment for scientists): <a class="reference external" href="https://store.enthought.com/">https://store.enthought.com/</a></li>
<li><a class="reference external" href="http://www.tapir.caltech.edu/~dtsang/python.html">http://www.tapir.caltech.edu/~dtsang/python.html</a></li>
<li><a class="reference external" href="http://penandpants.com/2012/02/24/install-python/">http://penandpants.com/2012/02/24/install-python/</a></li>
</ul>
</dd>
</dl>
<ul class="simple">
<li>Debian / Ubuntu:</li>
</ul>
<pre class="code bash literal-block">
sudo apt-get install python-matplotlib
</pre>
<ul class="simple">
<li>Windows: install <a class="reference external" href="https://store.enthought.com/">Canopy Express</a></li>
</ul>
</div>
<div class="section" id="alternatives">
<h3>Alternatives</h3>
<dl class="docutils">
<dt>Gnuplot:</dt>
<dd><ul class="first last simple">
<li>easy to use</li>
<li>open source (GPL)</li>
<li>hard to do &quot;complicated things&quot;</li>
<li>cannot pre-process your data (you need another script for this)</li>
</ul>
</dd>
<dt>Matlab:</dt>
<dd><ul class="first last simple">
<li>expensive</li>
<li>closed-source</li>
<li>does not deal very well with vector formats (SVG, PDF, EPS, etc.)</li>
</ul>
</dd>
<dt>R (ggplot2):</dt>
<dd><ul class="first last simple">
<li>open source</li>
<li>steep learning curve, sometimes not very flexible</li>
</ul>
</dd>
</dl>
</div>
</div>
</div>
<div class="section" id="basics">
<h1><a class="toc-backref" href="#id8">Basics</a></h1>
<div class="section" id="your-first-plot">
<h2><a class="toc-backref" href="#id9">Your first plot</a></h2>
<div class="admonition-how-to-test admonition">
<p class="first admonition-title">How to test?</p>
<ul class="last simple">
<li>launch <em>ipython --pylab</em> and copy-paste the script (interactive use)</li>
<li><strong>or</strong> save the script in a file and execute it with <em>python</em></li>
<li><strong>You can access to the source code by clicking on the figure</strong></li>
</ul>
</div>
<pre class="code python literal-block">
<span class="c"># Pylab includes numpy as 'np'</span>
<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># create an array of 256 points (x), from -pi to +pi</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>

<span class="c"># compute cos(x) [thanks to numpy, cos(x) returns an array]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c"># compute the plot</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c"># Show it in a new window</span>
<span class="n">show</span><span class="p">()</span>
</pre>
<a class="reference external image-reference" href="src/example1.py"><img alt="figs/first_plot.png" class="align-right" src="figs/first_plot.png" /></a>
<p>The <em>show()</em> function will create an interactive window in which you can zoom, move, and save the plot. If you want to save the plot to a file, use the function <em>savefig('filename.extension')</em> (Note: the function <em>savefig</em> must be called before function <em>show</em> if you call both functions). For example, to save our plot to a png file:</p>
<pre class="code python literal-block">
<span class="c"># Pylab includes numpy as 'np'</span>
<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># create an array of 256 points (x), from -pi to +pi</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>

<span class="c"># compute cos(x) [thanks to numpy, cos(x) returns an array]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c"># compute the plot</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c"># save in test.png (use test.pdf for a pdf file)</span>
<span class="n">savefig</span><span class="p">(</span><span class="s">&quot;test.png&quot;</span><span class="p">)</span>
</pre>
<p>Typical supported formats are (the exact list depends on the backend):</p>
<ul class="simple">
<li>pdf (vector format, useful for LaTeX papers compiled with pdflatex: no problem of resolution)</li>
<li>svg (vector format, useful to edit the graph with inkscape or Adobe Illustrator)</li>
<li>eps (vector format, useful for LaTeX papers compiled with the basic latex: no problem of resolution)</li>
<li>png (loseless bitmap)</li>
<li>jpg (do not use for plots)</li>
<li>gif (do not use for plots)</li>
</ul>
</div>
<div class="section" id="plotting-some-data">
<h2><a class="toc-backref" href="#id10">Plotting some data</a></h2>
<p>Matplotlib does not provide anything to load data from a file. However, since we are using python, we can use the standard methods to read a file. For instance, to read a file called &quot;file.dat&quot;, which contains:</p>
<pre class="literal-block">
2.3
1.5
1.2
4
5
9
</pre>
<p>We can use a simple loop (this approach is useful if your file is not a pure array of numbers, or if you want to skip some lines, etc.):</p>
<pre class="code python literal-block">
<span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="s">'file.dat'</span><span class="p">):</span>
  <span class="n">data</span> <span class="o">+=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">)]</span>
<span class="c"># to check</span>
<span class="k">print</span> <span class="n">data</span>
</pre>
<p>But we can also use numpy (one line of code):</p>
<pre class="code python literal-block">
<span class="c"># this will load numpy for us</span>
<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># load the file and store the result in data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s">'file.dat'</span><span class="p">)</span>
<span class="k">print</span> <span class="n">data</span>
</pre>
<a class="reference external image-reference" href="src/example2.py"><img alt="figs/example2.png" class="align-right" src="figs/example2.png" /></a>
<p>To plot the data, we use the same plot function as before. Don't forget to call <em>show()</em> if you want to see the plot on your screen (or <em>savefig()</em> if you want to save the plot).</p>
<pre class="code python literal-block">
<span class="c"># this will load numpy for us</span>
<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># load the file and store the result in data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s">'file.dat'</span><span class="p">)</span>

<span class="c"># generate a x array of the size of the file</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

<span class="c"># plot</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="n">show</span><span class="p">()</span>
</pre>
<a class="reference external image-reference" href="src/example2_bis.py"><img alt="figs/example2_bis.png" class="align-right" src="figs/example2_bis.png" /></a>
<p>To plot several lines, just call plot several times (the color is automatically selected). We add a label to identify each plot and call <em>legend()</em> to add a legend.</p>
<pre class="code python literal-block">
<span class="c"># this will load numpy for us</span>
<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># load the file and store the result in data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s">'file.dat'</span><span class="p">)</span>
<span class="n">data2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s">'file2.dat'</span><span class="p">)</span>

<span class="c"># generate a x array of the size of the file</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

<span class="c"># plot</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'data1'</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'data2'</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">savefig</span><span class="p">(</span><span class="s">'example2_bis.png'</span><span class="p">)</span>
</pre>
</div>
<div class="section" id="changing-the-color-and-the-type-of-line">
<h2><a class="toc-backref" href="#id11">Changing the color and the type of line</a></h2>
<div class="admonition-more admonition">
<p class="first admonition-title">More</p>
<ul class="last simple">
<li><a class="reference external" href="http://matplotlib.org/examples/pylab_examples/line_styles.html">Change the markers</a></li>
<li><a class="reference external" href="http://www.w3schools.com/tags/ref_colorpicker.asp">HTML color picker</a></li>
</ul>
</div>
<pre class="code python literal-block">
<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">):</span>
 <span class="n">y</span> <span class="o">+=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">i</span><span class="p">)]</span>

<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s">'red'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">'-'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'linestyle=&quot;_&quot;'</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s">'blue'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">'-'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'linestyle=&quot;-&quot;'</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s">'#aa0000'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'linestyle=&quot;--&quot;'</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s">'black'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">':'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'linestyle=&quot;:&quot;'</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s">'black'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">'-.'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'linestyle=&quot;-.&quot;'</span><span class="p">)</span>

<span class="n">legend</span><span class="p">()</span>
<span class="n">savefig</span><span class="p">(</span><span class="s">'example1_color.png'</span><span class="p">)</span>
</pre>
<a class="reference external image-reference" href="src/example1_color.py"><img alt="figs/example1_color.png" class="align-right" src="figs/example1_color.png" /></a>
<ul class="simple">
<li>Available linestyles: '_', '-', ':', '-.'</li>
<li>Available colors:</li>
</ul>
<blockquote>
<ul class="simple">
<li>basic names (&quot;red&quot;, &quot;blue&quot;, etc.)</li>
<li>HTML names (&quot;#FF0000&quot;, ...)</li>
<li>grayscale values (&quot;0.9&quot;)</li>
</ul>
</blockquote>
</div>
<div class="section" id="setting-the-limits-and-the-ticks">
<h2><a class="toc-backref" href="#id12">Setting the limits and the ticks</a></h2>
<div class="admonition-documentation admonition">
<p class="first admonition-title">Documentation</p>
<ul class="last simple">
<li><a class="reference external" href="http://matplotlib.sourceforge.net/api/pyplot_api.html#matplotlib.pyplot.xticks">xticks() command</a></li>
<li><a class="reference external" href="http://matplotlib.sourceforge.net/api/pyplot_api.html#matplotlib.pyplot.yticks">yticks() command</a></li>
<li><a class="reference external" href="http://matplotlib.sourceforge.net/api/axes_api.html?#matplotlib.axes.Axes.set_xticklabels">set_xticklabels()</a></li>
<li><a class="reference external" href="http://matplotlib.sourceforge.net/api/axes_api.html?#matplotlib.axes.Axes.set_yticklabels">set_yticklabels()</a></li>
</ul>
</div>
<p>Changing the limits:</p>
<pre class="code python literal-block">
<span class="n">xlim</span><span class="p">(</span><span class="n">min_value</span><span class="p">,</span> <span class="n">max_value</span><span class="p">)</span>
<span class="n">ylim</span><span class="p">(</span><span class="n">min_value</span><span class="p">,</span> <span class="n">max_value</span><span class="p">)</span>
</pre>
<p>The <em>ticks</em>:</p>
<pre class="code python literal-block">
<span class="c"># with automatic labeling</span>
<span class="n">xticks</span><span class="p">(</span><span class="n">list_of_ticks_positions</span><span class="p">)</span>
<span class="n">yticks</span><span class="p">(</span><span class="n">list_of_ticks_positions</span><span class="p">)</span>

<span class="c"># with custom labels</span>
<span class="n">xticks</span><span class="p">(</span><span class="n">list_of_ticks</span><span class="p">,</span> <span class="n">list_of_labels</span><span class="p">)</span>
<span class="n">yticks</span><span class="p">(</span><span class="n">list_of_ticks</span><span class="p">,</span> <span class="n">list_of_labels</span><span class="p">)</span>
</pre>
<a class="reference external image-reference" href="src/example2_lims.py"><img alt="figs/example2_lims.png" class="align-right" src="figs/example2_lims.png" /></a>
<p>Example:</p>
<pre class="code python literal-block">
<span class="c"># this will load numpy for us</span>
<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s">'file.dat'</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

<span class="c">#change the limits</span>
<span class="n">xlim</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">3.4</span><span class="p">)</span>
<span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="c">#ticks</span>
<span class="n">xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s">'T0'</span><span class="p">,</span> <span class="s">'T1'</span><span class="p">,</span> <span class="s">'T2'</span><span class="p">,</span> <span class="s">'T3'</span><span class="p">])</span>
<span class="c"># use np.arange to generate the array of ticks</span>
<span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>

<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="n">savefig</span><span class="p">(</span><span class="s">'example2_lims.png'</span><span class="p">)</span>
</pre>
</div>
</div>
<div class="section" id="data-over-time">
<h1><a class="toc-backref" href="#id13">Data over time</a></h1>
<div class="section" id="use-case">
<h2><a class="toc-backref" href="#id14">Use case</a></h2>
<ul class="simple">
<li>You launched an evolutionary algorithm 30 times (in our case, we used <a class="reference external" href="http://github.com/jbmouret/sferes2">sferes2</a>)</li>
<li>You want to see the <em>median maximum fitness</em> of all the runs, for each generation</li>
<li>You want to see the first and third quartiles</li>
<li>You want to see another data set (e.g. the median modularity) at the same time for each generation</li>
</ul>
</div>
<div class="section" id="id1">
<h2><a class="toc-backref" href="#id15">Basics</a></h2>
<div class="section" id="loading-the-data">
<h3>Loading the data</h3>
<p>You can download the data used in this example <a class="reference external" href="http://chronos.isir.upmc.fr/~mouret/alife_matplotlib/src/data/data.tar.gz">by following this link</a>.</p>
<p>Our data are organized as follows:</p>
<pre class="literal-block">
data/high_mut/exp_0/node10_2014-07-15_16_42_46_18276/bestfit.dat
data/high_mut/exp_1/node09_2014-07-15_16_42_46_7728/bestfit.dat
data/high_mut/exp_10/node11_2014-07-15_16_42_48_27645/bestfit.dat
data/high_mut/exp_11/node08_2014-07-15_16_42_48_8689/bestfit.dat
data/high_mut/exp_12/node09_2014-07-15_16_42_48_7770/bestfit.dat
[...]
data/low_mut/exp_0/node04_2014-07-15_16_42_46_11616/bestfit.dat
data/low_mut/exp_1/node10_2014-07-15_16_42_46_18277/bestfit.dat
data/low_mut/exp_10/node11_2014-07-15_16_42_48_27642/bestfit.dat
data/low_mut/exp_11/node02_2014-07-15_16_42_48_19205/bestfit.dat
data/low_mut/exp_12/node08_2014-07-15_16_42_48_8693/bestfit.dat
data/low_mut/exp_13/node07_2014-07-15_16_42_49_31387/bestfit.dat
</pre>
<p>For each line of each bestfit.dat, we have the generation and the fitness of the best individual:</p>
<pre class="literal-block">
0 -4026.84
1 -4026.84
2 -4026.84
3 -4026.84
4 -4026.84
5 -4026.84
6 -4026.84
7 -4026.84
8 -4026.84
9 -4026.84
10 -4026.84
[...]
</pre>
<div class="admonition-documentation admonition">
<p class="first admonition-title">Documentation</p>
<ul class="last simple">
<li><a class="reference external" href="https://docs.python.org/2/library/glob.html">glob()</a></li>
</ul>
</div>
<p>Let first load the data. We can use the <em>glob</em> module, from python, to get the list of relevant files:</p>
<pre class="code python literal-block">
<span class="c"># glob allows us to list the files that match a pattern</span>
<span class="kn">import</span> <span class="nn">glob</span>

<span class="c"># pylab will be useful later</span>
<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># a simple function to load our files</span>
<span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="nb">dir</span><span class="p">):</span>
    <span class="c"># example : exp_9/node05_2014-07-15_16_42_48_5178/bestfit.dat</span>
    <span class="n">f_list</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="nb">dir</span> <span class="o">+</span> <span class="s">'/*/*/bestfit.dat'</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">f_list</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">+=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">f</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">d</span>

<span class="c"># load our data</span>
<span class="n">data_low_mut</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="s">'data/low_mut'</span><span class="p">)</span>
<span class="n">data_high_mut</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="s">'data/high_mut'</span><span class="p">)</span>

<span class="k">print</span> <span class="n">data_low_mut</span>
<span class="k">print</span> <span class="n">data_high_mut</span>
</pre>
<div class="admonition-median-vs-mean admonition">
<p class="first admonition-title">Median vs Mean</p>
<p>Using the mean + standard deviation assumes that your data are <em>normally distributed</em>. This assumption is usually wrong in evolutionary computation (and in experimental computer science). For instance, your algorithm may fail 30% of the time (fitness = 0) and succeed 70% of the time (fitness = 1): you have two peaks and the distribution is not Gaussian at all. In addition, the standard deviation assumes that the distribution is symmetric, which is clearly not the case when there is a maximum that cannot be exceeded.</p>
<p class="last"><strong>You should always use the median and the 25% / 75% percentiles, unless you have good reason to think that your data are normally distributed</strong>.</p>
</div>
<p>However, our goal is to compute the median over all the runs, at each generation. We therefore need to re-organize the data to make this operation easy. We will re-organize the data in a matrix like this one:</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="19%" />
<col width="17%" />
<col width="17%" />
<col width="8%" />
<col width="19%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">&nbsp;</th>
<th class="head">Gen 1</th>
<th class="head">Gen 2</th>
<th class="head">Gen 3</th>
<th class="head">...</th>
<th class="head">Gen n</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>Run 1</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr><td>[...]</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr><td>Run k</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<pre class="code python literal-block">
<span class="c"># glob allows us to list the files that match a pattern</span>
<span class="kn">import</span> <span class="nn">glob</span>

<span class="c"># pylab will be useful later</span>
<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># a simple function to load our files</span>
<span class="c"># we assume that each file has the same number of rows (generations)</span>
<span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="nb">dir</span><span class="p">):</span>
    <span class="c"># example : exp_9/node05_2014-07-15_16_42_48_5178/bestfit.dat</span>
    <span class="n">f_list</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="nb">dir</span> <span class="o">+</span> <span class="s">'/*/*/bestfit.dat'</span><span class="p">)</span>

    <span class="c"># get the number of lines of the first file, to know the size of the matrix</span>
    <span class="n">num_lines</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">f_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

    <span class="c"># be careful that np.zeros takes a tuple as argument (size1, size)</span>
    <span class="c"># therefore we need two parentheses</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">f_list</span><span class="p">),</span> <span class="n">num_lines</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">f_list</span><span class="p">:</span>
        <span class="c"># we ignore the first column of the file</span>
        <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">f</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">data</span>

<span class="c"># load our data</span>
<span class="n">data_low_mut</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="s">'data/low_mut'</span><span class="p">)</span>
<span class="n">data_high_mut</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="s">'data/high_mut'</span><span class="p">)</span>
<span class="k">print</span> <span class="n">data_low_mut</span>
</pre>
<div class="admonition-documentation admonition">
<p class="first admonition-title">Documentation</p>
<ul class="last simple">
<li><a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.median.html">np.median()</a></li>
</ul>
</div>
<p>Now the data are nicely formatted, we can compute medians an plot them.</p>
<a class="reference external image-reference" href="src/plot_median.py"><img alt="figs/medians1.png" class="align-right" src="figs/medians1.png" /></a>
<pre class="code python literal-block">
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="nb">dir</span><span class="p">):</span>
    <span class="n">f_list</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="nb">dir</span> <span class="o">+</span> <span class="s">'/*/*/bestfit.dat'</span><span class="p">)</span>
    <span class="n">num_lines</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">f_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">f_list</span><span class="p">),</span> <span class="n">num_lines</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">f_list</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">f</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">data</span>

<span class="c"># compute the median of each column</span>
<span class="k">def</span> <span class="nf">med</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">median</span><span class="p">)):</span>
        <span class="n">median</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">median</span>

<span class="n">data_low_mut</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="s">'data/low_mut'</span><span class="p">)</span>
<span class="n">data_high_mut</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="s">'data/high_mut'</span><span class="p">)</span>

<span class="c"># generate the x</span>
<span class="n">n_generations</span> <span class="o">=</span> <span class="n">data_low_mut</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_generations</span><span class="p">)</span>

<span class="c"># compute the medians</span>
<span class="n">med_low_mut</span> <span class="o">=</span> <span class="n">med</span><span class="p">(</span><span class="n">data_low_mut</span><span class="p">)</span>
<span class="n">med_high_mut</span> <span class="o">=</span> <span class="n">med</span><span class="p">(</span><span class="n">data_high_mut</span><span class="p">)</span>

<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">med_low_mut</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">med_high_mut</span><span class="p">)</span>

<span class="n">savefig</span><span class="p">(</span><span class="s">'medians1.png'</span><span class="p">)</span>
</pre>
<p>We can use <em>xlim</em> and <em>lim</em> to see a bit better:</p>
<pre class="code python literal-block">
<span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
<span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</pre>
<a class="reference external image-reference" href="src/plot_median2.py"><img alt="figs/medians2.png" src="figs/medians2.png" /></a>
</div>
</div>
<div class="section" id="minimizing-ink">
<h2><a class="toc-backref" href="#id16">Minimizing ink</a></h2>
<img alt="figs/tufte_book_cover.png" class="align-left" src="figs/tufte_book_cover.png" />
<p>Probably the most influential book about data vizualization:</p>
<p>Tufte, Edward R. <em>The visual display of quantitative information.</em>, 2nd edition, Cheshire, CT: Graphics press, 2001.</p>
<p>Main principle: maximize the data / ink ratio. In other words, minimize the visual clutter, or remove everything that is not useful to understand the data.</p>
<dl class="docutils">
<dt>Example of bad vizualizations:</dt>
<dd><ul class="first last simple">
<li><a class="reference external" href="http://joeloughton.com/blog/wp-content/uploads/2011/04/chart13.gif">http://joeloughton.com/blog/wp-content/uploads/2011/04/chart13.gif</a> [from: <a class="reference external" href="http://joeloughton.com/blog/">http://joeloughton.com/blog/</a>]</li>
<li><a class="reference external" href="http://www.forbes.com/sites/naomirobbins/2012/05/30/winner-of-the-bad-graph-contest-announced-2/">http://www.forbes.com/sites/naomirobbins/2012/05/30/winner-of-the-bad-graph-contest-announced-2/</a></li>
</ul>
</dd>
<dt>Examples of a better vizualization (according to Tufte):</dt>
<dd><ul class="first last simple">
<li><a class="reference external" href="http://www.edwardtufte.com/bboard/q-and-a-fetch-msg?msg_id=00014g">http://www.edwardtufte.com/bboard/q-and-a-fetch-msg?msg_id=00014g</a></li>
<li><a class="reference external" href="http://infosthetics.com/archives/2010/03/obama_loves_infographics.html">http://infosthetics.com/archives/2010/03/obama_loves_infographics.html</a></li>
<li><a class="reference external" href="http://joeloughton.com/blog/visualisations/tufte-bar-chart-redesign-in-jquery-flot/">http://joeloughton.com/blog/visualisations/tufte-bar-chart-redesign-in-jquery-flot/</a></li>
<li><a class="reference external" href="http://blog.revolutionanalytics.com/2010/03/white-house-taps-edward-tufte-to-explain-the-stimulus.html">http://blog.revolutionanalytics.com/2010/03/white-house-taps-edward-tufte-to-explain-the-stimulus.html</a></li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="a-publication-quality-figure">
<h2><a class="toc-backref" href="#id17">A publication-quality figure</a></h2>
<a class="reference external image-reference" href="src/plot_medians3.py"><img alt="figs/medians3.png" class="align-right" src="figs/medians3.png" /></a>
<p>We first play with the parameters to get the size right:</p>
<pre class="code python literal-block">
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s">'axes.labelsize'</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
   <span class="s">'text.fontsize'</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
   <span class="s">'legend.fontsize'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
   <span class="s">'xtick.labelsize'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
   <span class="s">'ytick.labelsize'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
   <span class="s">'text.usetex'</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
   <span class="s">'figure.figsize'</span><span class="p">:</span> <span class="p">[</span><span class="mf">4.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">]</span>
   <span class="p">}</span>
<span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</pre>
<p>We do not really care about the exact size when our goal is to export a pdf or an eps (for LaTeX) because they are vector formats. However, we care about the ratio (length/width). Moreover, changing the size of the figure will affect the relative size of the fonts.</p>
<p>As a rule of thumb, the font size of your labels should be close to the font size of the figure's caption.</p>
<p>It is also a good idea to increase the linewidths, to be able to make the figure small:</p>
<pre class="code python literal-block">
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">med_low_mut</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'#B22400'</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">med_high_mut</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">'--'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'#006BB2'</span><span class="p">)</span>
</pre>
<p>And don't forget to add a caption. The parameter <em>loc</em> determines the position (1=top right, 2=top left, 3=bottom left, 4=bottom right). We can make the legend a bit prettier by removing the frame and putting a gray background.</p>
<pre class="code python literal-block">
<span class="n">legend</span> <span class="o">=</span> <span class="n">legend</span><span class="p">([</span><span class="s">&quot;Low mutation rate&quot;</span><span class="p">,</span> <span class="s">&quot;High Mutation rate&quot;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="mi">4</span><span class="p">);</span>
<span class="n">frame</span> <span class="o">=</span> <span class="n">legend</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span>
<span class="n">frame</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s">'0.9'</span><span class="p">)</span>
<span class="n">frame</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="s">'0.9'</span><span class="p">)</span>
</pre>
<p>We might also want to remove some ticks, to lighten the figure.</p>
<pre class="code python literal-block">
<span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
</pre>
<p>Last, we can make the figure a bit lighter by removing the frame and adding a light grid:</p>
<pre class="code python literal-block">
<span class="c"># put this _before_ the calls to plot and fill_between</span>
<span class="n">axes</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">grid</span><span class="p">()</span>
</pre>
</div>
<div class="section" id="adding-quartiles">
<h2><a class="toc-backref" href="#id18">Adding quartiles</a></h2>
<div class="admonition-documentation admonition">
<p class="first admonition-title">Documentation</p>
<ul class="last simple">
<li><a class="reference external" href="http://en.wikipedia.org/wiki/Quartile">Quartiles (Wikipedia)</a></li>
<li><a class="reference external" href="http://docs.scipy.org/doc/numpy-dev/reference/generated/numpy.percentile.html">percentile() (numpy)</a></li>
</ul>
</div>
<a class="reference external image-reference" href="src/plot_variance.py"><img alt="figs/variance.png" class="align-right" src="figs/variance.png" /></a>
<p>Quartiles are computed with numpy in the same way as the median, but using the function <em>percentile</em>.</p>
<pre class="code python literal-block">
<span class="k">def</span> <span class="nf">perc</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
   <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
   <span class="n">perc_25</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
   <span class="n">perc_75</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">median</span><span class="p">)):</span>
       <span class="n">median</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
       <span class="n">perc_25</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="mi">25</span><span class="p">)</span>
       <span class="n">perc_75</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="mi">25</span><span class="p">)</span>
   <span class="k">return</span> <span class="n">median</span><span class="p">,</span> <span class="n">perc_25</span><span class="p">,</span> <span class="n">perc_75</span>

 <span class="p">[</span><span class="o">...</span><span class="p">]</span>

<span class="c"># compute the medians and 25/75 percentiles</span>
<span class="n">med_low_mut</span><span class="p">,</span> <span class="n">perc_25_low_mut</span><span class="p">,</span> <span class="n">perc_75_low_mut</span> <span class="o">=</span> <span class="n">perc</span><span class="p">(</span><span class="n">data_low_mut</span><span class="p">)</span>
<span class="n">med_high_mut</span><span class="p">,</span> <span class="n">perc_25_high_mut</span><span class="p">,</span> <span class="n">perc_75_high_mut</span> <span class="o">=</span> <span class="n">perc</span><span class="p">(</span><span class="n">data_high_mut</span><span class="p">)</span>
</pre>
<p>We will use the function <em>fill_between</em> to display the quartiles on our plot. We use alpha=0.25 to get a nice transparency effect.</p>
<pre class="code python literal-block">
<span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">perc_25_low_mut</span><span class="p">,</span> <span class="n">perc_75_low_mut</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'#B22400'</span><span class="p">)</span>
<span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">perc_25_high_mut</span><span class="p">,</span> <span class="n">perc_75_high_mut</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'#006BB2'</span><span class="p">)</span>
</pre>
<div class="admonition-documentation admonition">
<p class="first admonition-title">Documentation</p>
<ul class="last simple">
<li><a class="reference external" href="http://matplotlib.org/api/pyplot_api.html">pylab / pyplot API</a></li>
</ul>
</div>
</div>
<div class="section" id="better-colors">
<h2><a class="toc-backref" href="#id19">Better colors</a></h2>
<p>Try to go away from the classic 100% red/100% blue/etc. There are many color scheme generators on the web: you select a nice color, and they generate matching colors, given the number of colors you need.</p>
<blockquote>
<ul class="simple">
<li><a class="reference external" href="http://www.paletton.com/">http://www.paletton.com/</a></li>
<li><a class="reference external" href="https://kuler.adobe.com/">https://kuler.adobe.com/</a></li>
<li><a class="reference external" href="http://www.perbang.dk/color+scheme/">http://www.perbang.dk/color+scheme/</a></li>
<li><a class="reference external" href="http://www.colorsontheweb.com/colorwizard.asp">http://www.colorsontheweb.com/colorwizard.asp</a></li>
</ul>
</blockquote>
<p>An interesting alternative is to use the python package brewer2mpl, which implements the guidelines published by <a class="reference external" href="http://www.personal.psu.edu/cab38/">C. Brewer</a> and colleagues  for coloring maps with sequential, divergent, and qualitative colors:  <a class="reference external" href="http://colorbrewer2.org/">http://colorbrewer2.org/</a></p>
<a class="reference external image-reference" href="src/plot_variance_mpl.py"><img alt="figs/variance_colors.png" class="align-right" src="figs/variance_colors.png" /></a>
<pre class="code bash literal-block">
sudo pip install brewer2mpl
</pre>
<p>And now, in our file:</p>
<pre class="code python literal-block">
<span class="kn">import</span> <span class="nn">brewer2mpl</span>

<span class="c"># brewer2mpl.get_map args: set name  set type  number of colors</span>
<span class="n">bmap</span> <span class="o">=</span> <span class="n">brewer2mpl</span><span class="o">.</span><span class="n">get_map</span><span class="p">(</span><span class="s">'Set2'</span><span class="p">,</span> <span class="s">'qualitative'</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">bmap</span><span class="o">.</span><span class="n">mpl_colors</span>
</pre>
<p>And we can use this array of colors in our plot commands:</p>
<pre class="code python literal-block">
<span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">perc_25_low_mut</span><span class="p">,</span> <span class="n">perc_75_low_mut</span><span class="p">,</span> \
         <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">perc_25_high_mut</span><span class="p">,</span> <span class="n">perc_75_high_mut</span><span class="p">,</span> \
         <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">med_low_mut</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">med_high_mut</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">'--'</span><span class="p">,</span> \
         <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre>
<p>And, by the way, let's use a simpler grid:</p>
<pre class="code python literal-block">
<span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">'y'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&quot;0.9&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">'-'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre>
<p>The box for the legend is useless now that we don't have vertical lines. Let's remove it (put it white):</p>
<pre class="code python literal-block">
<span class="n">frame</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s">'1.0'</span><span class="p">)</span>
<span class="n">frame</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="s">'1.0'</span><span class="p">)</span>
</pre>
</div>
<div class="section" id="pylab-vs-matplotlib">
<h2><a class="toc-backref" href="#id20">Pylab vs Matplotlib</a></h2>
<ul class="simple">
<li>Matplotlib: object-oriented interface -&gt; better for advanced scripts</li>
<li>Pylab: matlab-like interface (simple), on top of matplotlib -&gt; simple scripts or interactive use (<em>a la</em> matlab)</li>
</ul>
<p><strong>Warning</strong>: Having these two APIs can be confusing: in many situations, there is a function in pylab and a function in matplotlib. There are almost always two ways of doing something, and the examples found on the web often mix the two approaches.</p>
<p>Until now, we only used pylab functions but we need to use a more 'matplotlib way' to use subplots. Let first convert our last plot to matplotlib. In short:</p>
<blockquote>
<ul class="simple">
<li>we add a call to and store a pointer to the result in a variable <em>fig = figure()</em>. fig is an instance of the class Figure</li>
<li>we create a subplot and store a pointer to the result in ax <em>ax = fig.add_subplot(111)</em> [we will talk about the arguments of add_subplot in the next section]</li>
<li>now, all the plot-like commands should act on ax (e.g. <em>ax.plot(...)</em>); the savefig is a method of the Figure class.</li>
</ul>
</blockquote>
<p>So, the final file:</p>
<pre class="code python literal-block">
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">brewer2mpl</span>

 <span class="c"># brewer2mpl.get_map args: set name  set type  number of colors</span>
<span class="n">bmap</span> <span class="o">=</span> <span class="n">brewer2mpl</span><span class="o">.</span><span class="n">get_map</span><span class="p">(</span><span class="s">'Set2'</span><span class="p">,</span> <span class="s">'qualitative'</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">bmap</span><span class="o">.</span><span class="n">mpl_colors</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'axes.labelsize'</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="s">'text.fontsize'</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="s">'legend.fontsize'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s">'xtick.labelsize'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s">'ytick.labelsize'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s">'text.usetex'</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
    <span class="s">'figure.figsize'</span><span class="p">:</span> <span class="p">[</span><span class="mf">4.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="nb">dir</span><span class="p">):</span>
    <span class="n">f_list</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="nb">dir</span> <span class="o">+</span> <span class="s">'/*/*/bestfit.dat'</span><span class="p">)</span>
    <span class="n">num_lines</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">f_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">f_list</span><span class="p">),</span> <span class="n">num_lines</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">f_list</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">f</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">data</span>

<span class="k">def</span> <span class="nf">perc</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">perc_25</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">perc_75</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">median</span><span class="p">)):</span>
        <span class="n">median</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
        <span class="n">perc_25</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="mi">25</span><span class="p">)</span>
        <span class="n">perc_75</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="mi">75</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">median</span><span class="p">,</span> <span class="n">perc_25</span><span class="p">,</span> <span class="n">perc_75</span>

<span class="n">data_low_mut</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="s">'data/low_mut'</span><span class="p">)</span>
<span class="n">data_high_mut</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="s">'data/high_mut'</span><span class="p">)</span>

<span class="n">n_generations</span> <span class="o">=</span> <span class="n">data_low_mut</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_generations</span><span class="p">)</span>

<span class="n">med_low_mut</span><span class="p">,</span> <span class="n">perc_25_low_mut</span><span class="p">,</span> <span class="n">perc_75_low_mut</span> <span class="o">=</span> <span class="n">perc</span><span class="p">(</span><span class="n">data_low_mut</span><span class="p">)</span>
<span class="n">med_high_mut</span><span class="p">,</span> <span class="n">perc_25_high_mut</span><span class="p">,</span> <span class="n">perc_75_high_mut</span> <span class="o">=</span> <span class="n">perc</span><span class="p">(</span><span class="n">data_high_mut</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">figure</span><span class="p">()</span> <span class="c"># no frame</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="c"># now all plot function should be applied to ax</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">perc_25_low_mut</span><span class="p">,</span> <span class="n">perc_75_low_mut</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">perc_25_high_mut</span><span class="p">,</span> <span class="n">perc_75_high_mut</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">med_low_mut</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">med_high_mut</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">'--'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c"># change xlim to set_xlim</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

<span class="c">#change xticks to set_xticks</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>

<span class="n">legend</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s">&quot;Low mutation rate&quot;</span><span class="p">,</span> <span class="s">&quot;High Mutation rate&quot;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="mi">4</span><span class="p">);</span>
<span class="n">frame</span> <span class="o">=</span> <span class="n">legend</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span>
<span class="n">frame</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s">'1.0'</span><span class="p">)</span>
<span class="n">frame</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="s">'1.0'</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">'variance_matplotlib.png'</span><span class="p">)</span>
</pre>
<a class="reference external image-reference" href="src/plot_variance_matplotlib_white.py"><img alt="figs/variance_matplotlib.png" class="align-right" src="figs/variance_matplotlib.png" /></a>
<p>Now that we use the object-oriented API, we can improve our figure a bit by customizing the x-axis and the grid:</p>
<pre class="code python literal-block">
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s">'top'</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s">'right'</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s">'left'</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">tick_bottom</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">tick_left</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">'x'</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s">'out'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">'y'</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c"># offset the spines</span>
<span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
  <span class="n">spine</span><span class="o">.</span><span class="n">set_position</span><span class="p">((</span><span class="s">'outward'</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="c"># put the grid behind</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
</pre>
</div>
<div class="section" id="subplots">
<h2><a class="toc-backref" href="#id21">Subplots</a></h2>
<p>Let's say we want to have two figures side by side, with one figure being a 'zoomed' version of the other. Matplotlib uses the <em>add_subplot</em> method (class Figure), which returns a new instance of Axis. <em>add_subplot</em> takes 3 arguments:</p>
<ul class="simple">
<li>number of rows</li>
<li>number of columns</li>
<li>identifier of this specific subplot</li>
</ul>
<p>For instance:</p>
<ul class="simple">
<li><em>ax1 = fig.add_subplot(2, 1, 1)</em>: 2 rows of subplots, 1 column, and ax1 is the first subplot (top)</li>
<li><em>ax2 = fig.add_subplot(2, 1, 2)</em>: 2 rows, 1 line, and ax2 is the second subplot</li>
<li><em>ax1 = fig.add_subplot(1, 2, 1)</em>: 1 row, 2 columns, and ax1 is the first subplot (left)</li>
</ul>
<p>It is possible to use a single integer instead of the 3 arguments, for instance <em>fig.add_subplot(2, 1, 1)</em> can be written <em>fig.add_subplot(211)</em></p>
<p>To create our figure, we will put all our current code in a function that takes the axis and the limits in argument:</p>
<pre class="code python literal-block">
<span class="k">def</span> <span class="nf">plot_data</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">min_gen</span><span class="p">,</span> <span class="n">max_gen</span><span class="p">):</span>
  <span class="o">...</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">min_gen</span><span class="p">,</span> <span class="n">max_gen</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">min_gen</span><span class="p">,</span> <span class="n">max_gen</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
</pre>
<a class="reference external image-reference" href="src/plot_variance_subplots.py"><img alt="figs/variance_subplot.png" class="align-right" src="figs/variance_subplot.png" /></a>
<p>Then we simply call this function with different axes:</p>
<pre class="code python literal-block">
<span class="n">fig</span> <span class="o">=</span> <span class="n">figure</span><span class="p">()</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plot_data</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">plot_data</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">110</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">'variance_subplot.png'</span><span class="p">)</span>
</pre>
<p>As you can see, the result is far from perfect (yet!). First, we need to adjust the width of the figure:</p>
<pre class="code python literal-block">
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s">'axes.labelsize'</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
   <span class="s">'text.fontsize'</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
   <span class="s">'legend.fontsize'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
   <span class="s">'xtick.labelsize'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
   <span class="s">'ytick.labelsize'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
   <span class="s">'text.usetex'</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
   <span class="s">'figure.figsize'</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="c"># instead of 4.5, 4.5</span>
   <span class="p">}</span>
<span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</pre>
<p>The labels on the y axis are useless on the right plot, so let's remove them. Since the plot is done in the function <em>plot_data</em>, we add an argument to our function that deactivate these labels. We also do not need the legend twice, so we add another argument to deactivate it.</p>
<pre class="code python literal-block">
<span class="k">def</span> <span class="nf">plot_data</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">min_gen</span><span class="p">,</span> <span class="n">max_gen</span><span class="p">,</span> <span class="n">use_y_labels</span><span class="p">,</span> <span class="n">use_legend</span><span class="p">):</span>
  <span class="p">[</span><span class="o">...</span><span class="p">]</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="n">use_y_labels</span><span class="p">:</span>
     <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
  <span class="k">if</span> <span class="n">use_legend</span><span class="p">:</span>
    <span class="p">[</span><span class="o">...</span><span class="p">]</span>
</pre>
<p><strong>Advice:</strong> When you use subplots, put the code for each subplot in a different function (or the same function with different arguments).</p>
<p>The space between the two plots may be a bit too large, and there is also a large white space on the left and right borders. This can be adjusted with subplots_adjust:</p>
<pre class="code python literal-block">
<span class="n">fig</span> <span class="o">=</span> <span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.09</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="c"># wspace: the amount of width reserved for blank space between subplots</span>
<span class="c"># hspace: the amount of height reserved for white space between subplots</span>
<span class="c"># be careful that right=position of the right side, not amount of space</span>
<span class="c"># same thing for top and bottom</span>
</pre>
<p>One last thing: we need to label our subplots. This can be easily done with <em>text()</em> method of the class Figure. For instance:</p>
<pre class="code python literal-block">
<span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">,</span> <span class="s">&quot;A&quot;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s">&quot;bold&quot;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">'left'</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s">'center'</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.54</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">,</span> <span class="s">&quot;B&quot;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s">&quot;bold&quot;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">'left'</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s">'center'</span><span class="p">)</span>
</pre>
<p>The result:</p>
<a class="reference external image-reference" href="src/plot_variance_subplots_ter.py"><img alt="figs/variance_subplot_ter.png" src="figs/variance_subplot_ter.png" /></a>
</div>
</div>
<div class="section" id="box-plot">
<h1><a class="toc-backref" href="#id22">Box plot</a></h1>
<div class="section" id="id2">
<h2><a class="toc-backref" href="#id23">Use case</a></h2>
<p>You want to know if treatment 'A' performs better than treatment 'B'.</p>
<p>Goal:</p>
<ul class="simple">
<li>Display the median and the quartiles</li>
<li>Do not assume that your data are Gaussian (contrary to bars + error bars)</li>
</ul>
<div class="admonition-boxplot admonition">
<p class="first admonition-title">Boxplot</p>
<ul class="last simple">
<li><a class="reference external" href="http://en.wikipedia.org/wiki/Box_plot">Boxplot (Wikipedia)</a></li>
</ul>
</div>
<p>Boxplot:</p>
<ul class="simple">
<li>Each box extends from the lower to upper quartile values of the data, with a symbol at the median.</li>
<li>Whiskers extend to the most extreme data point within 1.5 * IQR, where IQR is the interquartile range.</li>
<li>Flier points (outliers) are those past the end of the whiskers.</li>
</ul>
</div>
<div class="section" id="id3">
<h2><a class="toc-backref" href="#id24">Basics</a></h2>
<p>We will use the same data as before and look at generation 100 (because there is not that much to see at generation 500...).</p>
<p>We load the data in the same way as before:</p>
<pre class="code python literal-block">
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="nb">dir</span><span class="p">):</span>
   <span class="n">f_list</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="nb">dir</span> <span class="o">+</span> <span class="s">'/*/*/bestfit.dat'</span><span class="p">)</span>
   <span class="n">num_lines</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">f_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
   <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">f_list</span><span class="p">),</span> <span class="n">num_lines</span><span class="p">))</span>
   <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">f_list</span><span class="p">:</span>
       <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">f</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>
       <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
   <span class="k">return</span> <span class="n">data</span>

<span class="n">data_low_mut</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="s">'data/low_mut'</span><span class="p">)</span>
<span class="n">data_high_mut</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="s">'data/high_mut'</span><span class="p">)</span>
</pre>
<p>As before, we create a figure and a sublot (could be useful later):</p>
<pre class="code python literal-block">
<span class="n">fig</span> <span class="o">=</span> <span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
</pre>
<a class="reference external image-reference" href="src/boxplot.py"><img alt="figs/boxplot1.png" class="align-right" src="figs/boxplot1.png" /></a>
<p>Since we are interested in the 100th generation, we extract the data from the maxtrix:</p>
<pre class="code python literal-block">
<span class="n">low_mut_100</span> <span class="o">=</span> <span class="n">data_low_mut</span><span class="p">[:,</span> <span class="mi">100</span><span class="p">]</span>
<span class="n">high_mut_100</span> <span class="o">=</span>  <span class="n">data_high_mut</span><span class="p">[:,</span> <span class="mi">100</span><span class="p">]</span>
</pre>
<p>Now we create a boxplot:</p>
<pre class="code python literal-block">
<span class="n">bp</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">([</span><span class="n">low_mut_100</span><span class="p">,</span> <span class="n">high_mut_100</span><span class="p">])</span>
</pre>
<p>... easy, but not pretty!</p>
<p>Let's first add the settings we used for the previous plot.</p>
<p>First, image and font size:</p>
<pre class="code python literal-block">
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s">'axes.labelsize'</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
   <span class="s">'text.fontsize'</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
   <span class="s">'legend.fontsize'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
   <span class="s">'xtick.labelsize'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
   <span class="s">'ytick.labelsize'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
   <span class="s">'text.usetex'</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
   <span class="s">'figure.figsize'</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</pre>
<a class="reference external image-reference" href="src/boxplot2.py"><img alt="figs/boxplot2.png" class="align-right" src="figs/boxplot2.png" /></a>
<p>Then we customize the frame:</p>
<pre class="code python literal-block">
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s">'top'</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s">'right'</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s">'left'</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">tick_bottom</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">tick_left</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">'x'</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s">'out'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">'y'</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre>
<p>... and add a grid</p>
<pre class="code python literal-block">
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">'y'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&quot;0.9&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">'-'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
</pre>
<p>Better but still not pretty...</p>
</div>
<div class="section" id="colored-boxes">
<h2><a class="toc-backref" href="#id25">Colored boxes</a></h2>
<p>Unfortunately, customizing the look of the boxes is not straighforward.</p>
<p>Given an instance of boxplot:</p>
<pre class="code python literal-block">
<span class="n">bp</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">([</span><span class="n">data_fit</span><span class="p">,</span> <span class="n">data_onp</span><span class="p">])</span>
</pre>
<a class="reference external image-reference" href="src/boxplot3.py"><img alt="figs/boxplot3.png" class="align-right" src="figs/boxplot3.png" /></a>
<p>We need to iterate over all the objects to change their attributes:</p>
<pre class="code python literal-block">
<span class="c"># colors, as before</span>
<span class="kn">import</span> <span class="nn">brewer2mpl</span>
<span class="n">bmap</span> <span class="o">=</span> <span class="n">brewer2mpl</span><span class="o">.</span><span class="n">get_map</span><span class="p">(</span><span class="s">'Set2'</span><span class="p">,</span> <span class="s">'qualitative'</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">bmap</span><span class="o">.</span><span class="n">mpl_colors</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">bp</span><span class="p">[</span><span class="s">'boxes'</span><span class="p">])):</span>
   <span class="n">bp</span><span class="p">[</span><span class="s">'boxes'</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
   <span class="c"># we have two whiskers!</span>
   <span class="n">bp</span><span class="p">[</span><span class="s">'whiskers'</span><span class="p">][</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
   <span class="n">bp</span><span class="p">[</span><span class="s">'whiskers'</span><span class="p">][</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
   <span class="n">bp</span><span class="p">[</span><span class="s">'whiskers'</span><span class="p">][</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
   <span class="n">bp</span><span class="p">[</span><span class="s">'whiskers'</span><span class="p">][</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
   <span class="c"># top and bottom fliers</span>
   <span class="c"># (set allows us to set many parameters at once)</span>
   <span class="n">bp</span><span class="p">[</span><span class="s">'fliers'</span><span class="p">][</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">markerfacecolor</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                   <span class="n">marker</span><span class="o">=</span><span class="s">'o'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
                   <span class="n">markeredgecolor</span><span class="o">=</span><span class="s">'none'</span><span class="p">)</span>
   <span class="n">bp</span><span class="p">[</span><span class="s">'fliers'</span><span class="p">][</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">markerfacecolor</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                   <span class="n">marker</span><span class="o">=</span><span class="s">'o'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
                   <span class="n">markeredgecolor</span><span class="o">=</span><span class="s">'none'</span><span class="p">)</span>
   <span class="n">bp</span><span class="p">[</span><span class="s">'medians'</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s">'black'</span><span class="p">)</span>
   <span class="n">bp</span><span class="p">[</span><span class="s">'medians'</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
   <span class="c"># and 4 caps to remove</span>
   <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">bp</span><span class="p">[</span><span class="s">'caps'</span><span class="p">]:</span>
       <span class="n">c</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre>
<a class="reference external image-reference" href="src/boxplot4.py"><img alt="figs/boxplot4.png" class="align-right" src="figs/boxplot4.png" /></a>
<p>I don't know any simple way to fill the boxes. A workaround is to redraw them (this is not a subtle way, but it works!):</p>
<pre class="code python literal-block">
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bp</span><span class="p">[</span><span class="s">'boxes'</span><span class="p">])):</span>
   <span class="n">box</span> <span class="o">=</span> <span class="n">bp</span><span class="p">[</span><span class="s">'boxes'</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
   <span class="n">box</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
   <span class="n">boxX</span> <span class="o">=</span> <span class="p">[]</span>
   <span class="n">boxY</span> <span class="o">=</span> <span class="p">[]</span>
   <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
       <span class="n">boxX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">box</span><span class="o">.</span><span class="n">get_xdata</span><span class="p">()[</span><span class="n">j</span><span class="p">])</span>
       <span class="n">boxY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">box</span><span class="o">.</span><span class="n">get_ydata</span><span class="p">()[</span><span class="n">j</span><span class="p">])</span>
       <span class="n">boxCoords</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">boxX</span><span class="p">,</span><span class="n">boxY</span><span class="p">)</span>
       <span class="n">boxPolygon</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">(</span><span class="n">boxCoords</span><span class="p">,</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
       <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">boxPolygon</span><span class="p">)</span>
</pre>
<p>Finally, to give more space to the y labels:</p>
<pre class="code python literal-block">
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre>
<p>And to have x labels:</p>
<pre class="code python literal-block">
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s">'low</span><span class="se">\n</span><span class="s">mutation'</span><span class="p">,</span><span class="s">'high</span><span class="se">\n</span><span class="s">mutation'</span><span class="p">])</span>
</pre>
</div>
<div class="section" id="stars-statistical-significance">
<h2><a class="toc-backref" href="#id26">Stars (statistical significance)</a></h2>
<div class="admonition-more-about-tests admonition">
<p class="first admonition-title">More about tests</p>
<p class="last">Sheskin, David J. &quot;Handbook of Parametric and Nonparametric Statistical Procedures.&quot; (2011). Chapman and Hall/CRC. ISBN: 1439858012</p>
</div>
<p>When comparing two treatments, we usually use stars to represent the p-value that results from a (well-chosen) statistical test.</p>
<p>There are <em>parametric</em> statistical tests (which assumes that the distribution of the data is known) and <em>non-parametric</em> tests (which do assume that the distribution is known). The classic <a class="reference external" href="http://en.wikipedia.org/wiki/Student's_t-test">Student's t-test</a> is a parametric test that only works when the data are normally distributed. <em>As explained before, data are rarely normally distributed when we compare algorithms</em> (but this is often the case in biology or in physics). A good non-parametric alternative to the t-test is the <a class="reference external" href="http://en.wikipedia.org/wiki/Mann%E2%80%93Whitney_U_test">Mann-Whitney U-test</a> (called ranksum in matlab, or Wilcoxon test, or Man-Whitney-Wilcoxon).</p>
<div class="admonition-scipy admonition">
<p class="first admonition-title">Scipy</p>
<ul class="last simple">
<li><a class="reference external" href="http://www.scipy.org">http://www.scipy.org</a></li>
<li><a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.mannwhitneyu.html">Mann-Whitney U test</a></li>
</ul>
</div>
<p>In python, there is an implementation in Scipy (a scientific package on top of numpy; if you don't have it yet: sudo pip install scipy or apt-get install it):</p>
<pre class="code python literal-block">
<span class="kn">import</span> <span class="nn">scipy.stats</span>
<span class="n">z</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">)</span>
</pre>
<p>We should usually use a <a class="reference external" href="http://en.wikipedia.org/wiki/One-_and_two-tailed_tests">two-tailed test</a> because we have no a priori about one treatment being better than the other. We should therefore multiply p by two to obtain the p-value:</p>
<pre class="code python literal-block">
<span class="n">p_value</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="mi">2</span>
</pre>
<p>This value is usually converted to stars as follows:</p>
<pre class="code python literal-block">
<span class="k">def</span> <span class="nf">stars</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
   <span class="k">if</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mf">0.0001</span><span class="p">:</span>
       <span class="k">return</span> <span class="s">&quot;****&quot;</span>
   <span class="k">elif</span> <span class="p">(</span><span class="n">p</span> <span class="o">&lt;</span> <span class="mf">0.001</span><span class="p">):</span>
       <span class="k">return</span> <span class="s">&quot;***&quot;</span>
   <span class="k">elif</span> <span class="p">(</span><span class="n">p</span> <span class="o">&lt;</span> <span class="mf">0.01</span><span class="p">):</span>
       <span class="k">return</span> <span class="s">&quot;**&quot;</span>
   <span class="k">elif</span> <span class="p">(</span><span class="n">p</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">):</span>
       <span class="k">return</span> <span class="s">&quot;*&quot;</span>
   <span class="k">else</span><span class="p">:</span>
       <span class="k">return</span> <span class="s">&quot;-&quot;</span>

 <span class="p">[</span><span class="o">...</span><span class="p">]</span>
 <span class="n">z</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">low_mut_100</span><span class="p">,</span> <span class="n">high_mut_100</span><span class="p">)</span>
 <span class="n">p_value</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="mi">2</span>
 <span class="n">s</span> <span class="o">=</span> <span class="n">stars</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre>
<div class="admonition-documentation admonition">
<p class="first admonition-title">Documentation</p>
<p class="last"><a class="reference external" href="http://matplotlib.org/users/annotations_intro.html">Annotating text</a></p>
</div>
<a class="reference external image-reference" href="src/boxplot5.py"><img alt="figs/boxplot5.png" class="align-right" src="figs/boxplot5.png" /></a>
<p>The next step is to draw these stars on our plot using the <em>annotate</em> method (you may have to fine-tune the y-coordinates of the stars).</p>
<pre class="code python literal-block">
<span class="n">y_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">low_mut_100</span><span class="p">,</span> <span class="n">high_mut_100</span><span class="p">)))</span>
<span class="n">y_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">low_mut_100</span><span class="p">,</span> <span class="n">high_mut_100</span><span class="p">)))</span>
<span class="k">print</span> <span class="n">y_max</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">y_max</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="s">'data'</span><span class="p">,</span>
           <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">y_max</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s">'data'</span><span class="p">,</span>
           <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s">&quot;-&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s">'#aaaaaa'</span><span class="p">,</span>
                           <span class="n">connectionstyle</span><span class="o">=</span><span class="s">&quot;bar,fraction=0.2&quot;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">y_max</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">y_max</span> <span class="o">-</span> <span class="n">y_min</span><span class="p">)</span><span class="o">*</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">stars</span><span class="p">(</span><span class="n">p_value</span><span class="p">),</span>
       <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span>
       <span class="n">verticalalignment</span><span class="o">=</span><span class="s">'center'</span><span class="p">)</span>
</pre>
<p>And the final file:</p>
<pre class="code python literal-block">
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span>

<span class="kn">import</span> <span class="nn">brewer2mpl</span>
<span class="n">bmap</span> <span class="o">=</span> <span class="n">brewer2mpl</span><span class="o">.</span><span class="n">get_map</span><span class="p">(</span><span class="s">'Set2'</span><span class="p">,</span> <span class="s">'qualitative'</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">bmap</span><span class="o">.</span><span class="n">mpl_colors</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'axes.labelsize'</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="s">'text.fontsize'</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="s">'legend.fontsize'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s">'xtick.labelsize'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s">'ytick.labelsize'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s">'text.usetex'</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
    <span class="s">'figure.figsize'</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="nb">dir</span><span class="p">):</span>
    <span class="n">f_list</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="nb">dir</span> <span class="o">+</span> <span class="s">'/*/*/bestfit.dat'</span><span class="p">)</span>
    <span class="n">num_lines</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">f_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">f_list</span><span class="p">),</span> <span class="n">num_lines</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">f_list</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">f</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">data</span>


<span class="k">def</span> <span class="nf">stars</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mf">0.0001</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">&quot;****&quot;</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">p</span> <span class="o">&lt;</span> <span class="mf">0.001</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;***&quot;</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">p</span> <span class="o">&lt;</span> <span class="mf">0.01</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;**&quot;</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">p</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;*&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">&quot;-&quot;</span>

<span class="n">data_low_mut</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="s">'data/low_mut'</span><span class="p">)</span>
<span class="n">data_high_mut</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="s">'data/high_mut'</span><span class="p">)</span>
<span class="n">low_mut_100</span> <span class="o">=</span> <span class="n">data_low_mut</span><span class="p">[:,</span> <span class="mi">100</span><span class="p">]</span>
<span class="n">high_mut_100</span> <span class="o">=</span>  <span class="n">data_high_mut</span><span class="p">[:,</span> <span class="mi">100</span><span class="p">]</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">bp</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">([</span><span class="n">low_mut_100</span><span class="p">,</span> <span class="n">high_mut_100</span><span class="p">],</span> <span class="n">notch</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sym</span><span class="o">=</span><span class="s">'b+'</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">whis</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
             <span class="n">positions</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">widths</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>


<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bp</span><span class="p">[</span><span class="s">'boxes'</span><span class="p">])):</span>
    <span class="n">box</span> <span class="o">=</span> <span class="n">bp</span><span class="p">[</span><span class="s">'boxes'</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
    <span class="n">box</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">boxX</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">boxY</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">boxX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">box</span><span class="o">.</span><span class="n">get_xdata</span><span class="p">()[</span><span class="n">j</span><span class="p">])</span>
        <span class="n">boxY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">box</span><span class="o">.</span><span class="n">get_ydata</span><span class="p">()[</span><span class="n">j</span><span class="p">])</span>
        <span class="n">boxCoords</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">boxX</span><span class="p">,</span><span class="n">boxY</span><span class="p">)</span>
        <span class="n">boxPolygon</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">(</span><span class="n">boxCoords</span><span class="p">,</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">boxPolygon</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">bp</span><span class="p">[</span><span class="s">'boxes'</span><span class="p">])):</span>
    <span class="n">bp</span><span class="p">[</span><span class="s">'boxes'</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="c"># we have two whiskers!</span>
    <span class="n">bp</span><span class="p">[</span><span class="s">'whiskers'</span><span class="p">][</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">bp</span><span class="p">[</span><span class="s">'whiskers'</span><span class="p">][</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">bp</span><span class="p">[</span><span class="s">'whiskers'</span><span class="p">][</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">bp</span><span class="p">[</span><span class="s">'whiskers'</span><span class="p">][</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="c"># top and bottom fliers</span>
    <span class="n">bp</span><span class="p">[</span><span class="s">'fliers'</span><span class="p">][</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">markerfacecolor</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">marker</span><span class="o">=</span><span class="s">'o'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
                    <span class="n">markeredgecolor</span><span class="o">=</span><span class="s">'none'</span><span class="p">)</span>
    <span class="n">bp</span><span class="p">[</span><span class="s">'fliers'</span><span class="p">][</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">markerfacecolor</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">marker</span><span class="o">=</span><span class="s">'o'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
                    <span class="n">markeredgecolor</span><span class="o">=</span><span class="s">'none'</span><span class="p">)</span>
    <span class="n">bp</span><span class="p">[</span><span class="s">'medians'</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s">'black'</span><span class="p">)</span>
    <span class="n">bp</span><span class="p">[</span><span class="s">'medians'</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="c"># and 4 caps to remove</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">bp</span><span class="p">[</span><span class="s">'caps'</span><span class="p">]:</span>
        <span class="n">c</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s">'top'</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s">'right'</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s">'left'</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">tick_bottom</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">tick_left</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">'x'</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s">'out'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">'y'</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">'y'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&quot;0.9&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">'-'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s">'low</span><span class="se">\n</span><span class="s">mutation'</span><span class="p">,</span><span class="s">'high</span><span class="se">\n</span><span class="s">mutation'</span><span class="p">])</span>

<span class="c"># the stars</span>
<span class="n">z</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">low_mut_100</span><span class="p">,</span> <span class="n">high_mut_100</span><span class="p">)</span>
<span class="n">p_value</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">stars</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

<span class="n">y_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">low_mut_100</span><span class="p">,</span> <span class="n">high_mut_100</span><span class="p">)))</span>
<span class="n">y_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">low_mut_100</span><span class="p">,</span> <span class="n">high_mut_100</span><span class="p">)))</span>
<span class="k">print</span> <span class="n">y_max</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">y_max</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="s">'data'</span><span class="p">,</span>
            <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">y_max</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s">'data'</span><span class="p">,</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s">&quot;-&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s">'#aaaaaa'</span><span class="p">,</span>
                            <span class="n">connectionstyle</span><span class="o">=</span><span class="s">&quot;bar,fraction=0.2&quot;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">y_max</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">y_max</span> <span class="o">-</span> <span class="n">y_min</span><span class="p">)</span><span class="o">*</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">stars</span><span class="p">(</span><span class="n">p_value</span><span class="p">),</span>
        <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span>
        <span class="n">verticalalignment</span><span class="o">=</span><span class="s">'center'</span><span class="p">)</span>


<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>


<span class="n">savefig</span><span class="p">(</span><span class="s">'boxplot5.png'</span><span class="p">)</span>
</pre>
<p>Generated with: rst2html.py --syntax-highlight=short --stylesheet=dana.css,style.css matplotlib.rst &gt; matplotlib.html</p>
</div>
</div>
</div>
</body>
</html>
